# 伪造中本聪数字签名的推导与实现

## 1. 引言

本文基于ECDSA签名的数学原理，演示如何伪造符合验证条件的数字签名，探讨伪造的数学依据及实现细节。

## 2. ECDSA签名验证公式回顾

签名 `(r, s)` 对消息哈希 `e` 和公钥 `Q` 的验证条件为：

```bash
s^{-1}eG + s^{-1}rQ = R
```
其中 `R` 的 x 坐标模 n 后应等于 `r`。

## 3. 伪造签名的数学推导

通过选取任意 `u, v`，计算
```bash
R = uG + vQ
r = R_x mod n
s = r * mod_inv(v, n) mod n
e = r * mod_inv(u, n) mod n
```

则 `(r, s)` 是对消息哈希 `e` 的合法签名。

## 4. PoC代码示例

详见 `src/forgery.py`。

## 5. 安全建议

- 哈希函数应保证预映像不可控  
- 私钥保密，随机数生成安全  
- 采用抗伪造的签名方案  

## 6. 结论

伪造签名体现了签名方案数学结构中的潜在风险，强调了安全设计的重要性。

